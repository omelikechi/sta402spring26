for(i in 1:n){
data_var <- data_var + (data[i,] %*% t(data[i,]))
}
sigma_mle <- (1/n)*data_var
# Samples using true values
set.seed(1)
y_true <- rmvnorm(10000, theta, sigma)
# Samples using MLE
set.seed(2)
y_mle <- rmvnorm(10000, theta_mle, sigma_mle)
# Plotting
qplot(y_true[,1], y_true[,2], xlab = expression(y[1]),
ylab = expression(y[2]), main = "True values", geom = "density2d", bins = 50,
asp = 1) + theme(plot.title = element_text(hjust = 0.5))
qplot(y_mle[,1], y_mle[,2], xlab = expression(y[1]),
ylab = expression(y[2]), main = "MLE values", geom = "density2d", bins = 50,
asp = 1) + theme(plot.title = element_text(hjust = 0.5))
# Gibbs sampler
# Hyperparameters for priors
theta_0 <- c(0,0)
Sigma_0 <- diag(2)
nu_0 <- 4
S_0 <- diag(2)
# Initial value for Gibbs sampler
Sigma <- cov(data)
# Set null matrices to save samples
THETA <- SIGMA <- NULL
#Gibbs sampler
# Iterations and burn-in
n_iter <- 10000; burn_in <- 0.3*n_iter
set.seed(3)
for (s in 1:(n_iter+burn_in)){
# Update theta using its full conditional
Sigma_n <- solve(solve(Sigma_0) + n*solve(Sigma))
theta_n <- Sigma_n %*% (solve(Sigma_0)%*%theta_0 + n*solve(Sigma)%*%theta_mle)
theta <- rmvnorm(1,theta_n,Sigma_n)
# Update Sigma
S_theta <- (t(data)-c(theta))%*%t(t(data)-c(theta))
S_n <- S_0 + S_theta
nu_n <- nu_0 + n
Sigma <- riwish(nu_n, S_n)
# Save results only past burn-in
if(s > burn_in){
THETA <- rbind(THETA,theta)
SIGMA <- rbind(SIGMA,c(Sigma))
}
}
qplot(THETA[,1], THETA[,2], xlab = expression(y[1]),
ylab = expression(y[2]), main = "Bayes estimates", geom = "density2d", bins = 50,
asp = 1) + theme(plot.title = element_text(hjust = 0.5))
data <- scan(file = url("http://www2.stat.duke.edu/~pdh10/FCBS/Exercises/agehw.dat"))
data <- read.table(file = url("http://www2.stat.duke.edu/~pdh10/FCBS/Exercises/agehw.dat"), header = T)
data <- read.table(file = url("http://www2.stat.duke.edu/~pdh10/FCBS/Exercises/agehw.dat"), header = T)
head(data)
length(data)
length(data[1])
length(data[1,])
length(data[,1])
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(36,18,18,36), nrow=2, ncol=2)
# Sample from prior
Y <- rmvnorm(100,theta_0,Sigma_0)
Y
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(36,18,18,36), nrow=2, ncol=2)
# Sample from priors
theta_sample <- rmvnorm(1, theta_0, Sigma_0)
Sigma_sample <- riwish(4, Sigma_0)
theta_sample
Sigma_sample
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(36,18,18,36), nrow=2, ncol=2)
# Sample from priors
theta_sample <- rmvnorm(1, theta_0, Sigma_0)
Sigma_sample <- riwish(4, Sigma_0)
Sigma_sample
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(36,18,18,36), nrow=2, ncol=2)
# Sample from priors
theta_sample <- rmvnorm(1, theta_0, Sigma_0)
Sigma_sample <- riwish(4, Sigma_0)
Sigma_sample <- riwish(4, Sigma_0)
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(36,18,18,36), nrow=2, ncol=2)
# Sample from priors
theta_sample <- rmvnorm(1, theta_0, Sigma_0)
Sigma_sample <- riwish(4, Sigma_0)
Sigma_sample
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(36,18,18,36), nrow=2, ncol=2)
# Sample from priors
theta_sample <- rmvnorm(1, theta_0, Sigma_0)
Sigma_sample <- riwish(4, Sigma_0)
# Prior predictive data
Y <- rmvnorm(100, theta_sample, Sigma_sample)
Y[1,]
Y[,1]
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(9,4.5,4.5,9), nrow=2, ncol=2)
# Sample from priors
theta_sample <- rmvnorm(1, theta_0, Sigma_0)
Sigma_sample <- riwish(4, Sigma_0)
# Prior predictive data
Y <- rmvnorm(100, theta_sample, Sigma_sample)
Y[,1]
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(16,8,8,16), nrow=2, ncol=2)
# Sample from priors
theta_sample <- rmvnorm(1, theta_0, Sigma_0)
Sigma_sample <- riwish(4, Sigma_0)
# Prior predictive data
Y <- rmvnorm(100, theta_sample, Sigma_sample)
Y
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(16,8,8,16), nrow=2, ncol=2)
# Sample from priors
theta_sample <- rmvnorm(1, theta_0, Sigma_0)
Sigma_sample <- riwish(4, Sigma_0)
# Prior predictive data
Y <- rmvnorm(100, theta_sample, Sigma_sample)
theta_sample
Y[,1]
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(25,10,10,16), nrow=2, ncol=2)
# Sample from priors
theta_sample <- rmvnorm(1, theta_0, Sigma_0)
Sigma_sample <- riwish(4, Sigma_0)
# Prior predictive data
Y <- rmvnorm(100, theta_sample, Sigma_sample)
theta_sample
Y[,1]
Y[,2]
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(25,10,10,16), nrow=2, ncol=2)
# Sample from priors
theta_sample <- rmvnorm(1, theta_0, Sigma_0)
Sigma_sample <- riwish(4, Sigma_0)
# Prior predictive data
Y <- rmvnorm(100, theta_sample, Sigma_sample)
# Plot
plot(Y[,1], Y[,2])
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(25,10,10,16), nrow=2, ncol=2)
# Sample from priors
theta_sample <- rmvnorm(1, theta_0, Sigma_0)
Sigma_sample <- riwish(4, Sigma_0)
# Prior predictive data
Y <- rmvnorm(100, theta_sample, Sigma_sample)
# Plot
plot(Y[,1], Y[,2])
# Prior mean and covariance
theta_0 <- c(30,28)
Sigma_0 <- matrix(c(25,10,10,16), nrow=2, ncol=2)
# Sample from priors
theta_sample <- rmvnorm(1, theta_0, Sigma_0)
Sigma_sample <- riwish(4, Sigma_0)
# Prior predictive data
Y <- rmvnorm(100, theta_sample, Sigma_sample)
# Plot
plot(Y[,1], Y[,2])
# Prior mean and covariance
theta_0 <- c(30,28)
Sigma_0 <- matrix(c(25,10,10,16), nrow=2, ncol=2)
# Sample from priors
theta_sample <- rmvnorm(1, theta_0, Sigma_0)
Sigma_sample <- riwish(4, Sigma_0)
# Prior predictive data
Y <- rmvnorm(100, theta_sample, Sigma_sample)
# Plot
plot(Y[,1], Y[,2])
# Prior mean and covariance
theta_0 <- c(30,28)
Sigma_0 <- matrix(c(25,10,10,16), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(4, Sigma_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(4, Sigma_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(4, Sigma_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2])
plot(Y[,1], Y[,2])
plot(Z[,1], Z[,2])
# Prior mean and covariance
theta_0 <- c(30,28)
Sigma_0 <- matrix(c(25,10,10,16), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(4, Sigma_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(4, Sigma_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(4, Sigma_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(30,28)
Sigma_0 <- matrix(c(25,10,10,16), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(4, Sigma_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(4, Sigma_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(40, Sigma_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(30,28)
Sigma_0 <- matrix(c(25,10,10,16), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(4, Sigma_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(4, Sigma_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(10, Sigma_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(30,28)
Sigma_0 <- matrix(c(25,12.5,12.5,25), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(4, Sigma_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(4, Sigma_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(10, Sigma_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(30,28)
Sigma_0 <- matrix(c(16,8,8,16), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(4, Sigma_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(4, Sigma_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(10, Sigma_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(30,28)
Sigma_0 <- matrix(c(16,8,8,16), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(10, Sigma_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(10, Sigma_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(10, Sigma_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(30,28)
Sigma_0 <- matrix(c(25,10,10,16), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(10, Sigma_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(10, Sigma_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(10, Sigma_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(30,28)
Sigma_0 <- matrix(c(25,12.5,12.5,25), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(10, Sigma_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(10, Sigma_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(10, Sigma_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(30,28)
Sigma_0 <- matrix(c(25,12.5,12.5,25), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(8, Sigma_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(8, Sigma_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(8, Sigma_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(30,28)
Sigma_0 <- matrix(c(25,12.5,12.5,25), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(8, Sigma_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(8, Sigma_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(8, Sigma_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(9,4.5,4.5,9), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(8, Sigma_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(8, Sigma_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(8, Sigma_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(9,4.5,4.5,9), nrow=2, ncol=2)
S_0 <- matrix(c(25,10,10,16), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(8, S_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(8, S_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(8, S_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(4,2,2,4), nrow=2, ncol=2)
S_0 <- matrix(c(36,18,18,25), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(8, S_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(8, S_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(8, S_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(4,2,2,4), nrow=2, ncol=2)
S_0 <- matrix(c(36,18,18,25), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(8, S_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(8, S_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(8, S_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(4,2,2,4), nrow=2, ncol=2)
S_0 <- matrix(c(36,18,18,25), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(4, S_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(4, S_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(4, S_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(28,26)
Sigma_0 <- matrix(c(4,2,2,4), nrow=2, ncol=2)
S_0 <- matrix(c(36,18,18,25), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(8, S_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(8, S_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(8, S_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
# Prior mean and covariance
theta_0 <- c(30,28)
Sigma_0 <- matrix(c(4,2,2,4), nrow=2, ncol=2)
S_0 <- matrix(c(36,18,18,25), nrow=2, ncol=2)
# Three samples from priors
theta_x <- rmvnorm(1, theta_0, Sigma_0)
Sigma_x <- riwish(8, S_0)
theta_y <- rmvnorm(1, theta_0, Sigma_0)
Sigma_y <- riwish(8, S_0)
theta_z <- rmvnorm(1, theta_0, Sigma_0)
Sigma_z <- riwish(8, S_0)
# Prior predictive data
X <- rmvnorm(100, theta_x, Sigma_x)
Y <- rmvnorm(100, theta_y, Sigma_y)
Z <- rmvnorm(100, theta_z, Sigma_z)
# Plot
plot(X[,1], X[,2], xlab="Husband age", ylab="Wife age")
plot(Y[,1], Y[,2], xlab="Husband age", ylab="Wife age")
plot(Z[,1], Z[,2], xlab="Husband age", ylab="Wife age")
