mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 100
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
P <- append(Prob,p)
}
P
Prob
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 100
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
Prob <- append(Prob,p)
}
Prob
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 100
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
cat(p)
Prob <- append(Prob,p)
}
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 100
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
print(p)
Prob <- append(Prob,p)
}
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 100
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
print("When", p)
Prob <- append(Prob,p)
}
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 100
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
cat("When", p)
Prob <- append(Prob,p)
}
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 100
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
cat("When", p, " ")
Prob <- append(Prob,p)
}
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 100
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
cat("When k_0=v_0=", k_0, "the probability is", p., " ")
Prob <- append(Prob,p)
}
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 100
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
cat("When k_0=v_0=", k_0, "the probability is", p, ". ")
Prob <- append(Prob,p)
}
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 10000
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
print(p)
Prob <- append(Prob,p)
}
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 10000
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
print(p)
Prob <- append(Prob,p)
}
N <- c()
for (i in c(0:5))
{
N <- append(N, 2^i)
}
plot(N,Prob)
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 10000
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
print(p)
Prob <- append(Prob,p)
}
N <- c()
for (i in c(0:5))
{
N <- append(N, 2^i)
}
plot(N,Prob, ylab=expression("Probability"~theta_A<theta_B))
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 10000
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
print(p)
Prob <- append(Prob,p)
}
N <- c()
for (i in c(0:5))
{
N <- append(N, 2^i)
}
plot(N,Prob, ylab=expression("Probability" ~ theta<theta))
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 10000
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
print(p)
Prob <- append(Prob,p)
}
N <- c()
for (i in c(0:5))
{
N <- append(N, 2^i)
}
plot(N,Prob, ylab=expression("Probability" ~ theta[A]<theta[B]))
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 10000
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
print(p)
Prob <- append(Prob,p)
}
N <- c()
for (i in c(0:5))
{
N <- append(N, 2^i)
}
plot(N,Prob, ylab=expression(Pr(theta[A]<theta[B]|y[A],y[B])))
n <- 16
mu_0 <- 75
sigma_0 <- 10
yA_bar <- 75.2 ; sA <- 7.3
yB_bar <- 77.5 ; sB <- 8.1
Prob <- c()
for (i in c(0:5))
{
# Prior
k_0 <- 2^i
nu_0 <- 2^i
# Posterior
k <- k_0+n
nu <- nu_0+n
mu_A <- (k_0*mu_0+n*yA_bar)/k
mu_B <- (k_0*mu_0+n*yB_bar)/k
sigma_A_squared <- (nu_0*sigma_0^2+(n-1)*sA^2+k_0*n*(yA_bar-mu_0)^2/k)/nu
sigma_B_squared <- (nu_0*sigma_0^2+(n-1)*sB^2+k_0*n*(yB_bar-mu_0)^2/k)/nu
# Monte Carlo samples
m <- 10000
sigma_A_squared_sample <- 1/rgamma(m, nu/2, sigma_A_squared*nu/2)
sigma_B_squared_sample <- 1/rgamma(m, nu/2, sigma_B_squared*nu/2)
theta_A_sample <- rnorm(m, mu_A, sqrt(sigma_A_squared_sample/k))
theta_B_sample <- rnorm(m, mu_B, sqrt(sigma_B_squared_sample/k))
# Probability theta_A < theta_B
p <- sum(theta_A_sample<theta_B_sample)/m
print(p)
Prob <- append(Prob,p)
}
N <- c()
for (i in c(0:5))
{
N <- append(N, 2^i)
}
plot(N,Prob, ylab=expression(Pr(theta[A]<theta[B] ~ "given" ~ y[A],y[B])))
for (i in c(0:5))
{
print(Prob[i])
}
for (i in c(1:5))
{
print(Prob[i])
}
for (i in c(1:6))
{
print(Prob[i])
}
