require(rstan)
require(tidyverse)
require(rstanarm)
require(magrittr)
ggplot2::theme_set(ggplot2::theme_bw())
knitr::opts_chunk$set(fig.align = 'center')
stan_dat <- list(y = y, x=x, N=N)
create_df <- function(post_draws, prior_draws){
post_draws <- data.frame(post_draws)
post_draws$distribution <- "posterior"
prior_draws <- data.frame(prior_draws)
colnames(prior_draws) <- "alpha"
prior_draws$distribution <- "prior"
dat <- rbind(post_draws, prior_draws)
return(dat)
}
set.seed(689934)
alpha <- 1
beta <- -0.25
sigma <- 1
N <- 5
x <- array(runif(N, 0, 2), dim=N)
y <- array(rnorm(N, beta * x + alpha, sigma), dim=N)
stan_dat <- list(y = y, x=x, N=N)
fit.flat <- stan(file = "lab-04-flat_prior.stan", data = stan_dat, chains = 1, refresh = 0, iter = 2000, warmup = 500, seed=48)
alpha.flat <- as.matrix(fit.flat, pars = "alpha")
beta.flat <- as.matrix(fit.flat, pars = "beta")
stan_dat <- list(y = y, x=x, N=N)
fit.norm <- stan(file = "lab-04-normal_prior.stan", data = stan_dat, chains = 1, refresh = 0, iter = 2000, warmup = 500, seed=49)
alpha.norm<- as.matrix(fit.norm, pars = c("alpha"))
stan_dat <- list(y = y, x=x, N=N)
fit.norm <- stan(file = "lab-04-normal_prior.stan", data = stan_dat, chains = 1, refresh = 0, iter = 2000, warmup = 500, seed=49)
alpha.norm<- as.matrix(fit.norm, pars = c("alpha"))
beta.norm<- as.matrix(fit.norm, pars = c("beta"))
plot_dat <- create_df(alpha.norm, alpha.cauchy) %>%
mutate(distribution = if_else(distribution == "posterior", "Normal","Cauchy"))
stan_dat <- list(y = y, x=x, N=N)
fit.cauchy <- stan(file = "lab-04-cauchy_prior.stan",data = stan_dat, chains = 1, refresh = 0, iter = 2000, warmup = 500, seed=55)
alpha.cauchy<- as.matrix(fit.cauchy, pars = c("alpha"))
plot_dat <- create_df(alpha.norm, alpha.cauchy) %>%
mutate(distribution = if_else(distribution == "posterior", "Normal","Cauchy"))
ggplot(plot_dat, aes(alpha, fill = distribution)) +
geom_histogram(binwidth = 0.25, alpha = 0.7, position = "identity")+
geom_vline(xintercept = alpha) +
scale_fill_brewer()
set.seed(123);
theta <- 0.3;
N <- 10;
y <- rbinom(N, 1, theta)
stan_dat <- list(y = y,N=N)
fit.bayes.prob <- stan(file = "lab-04-prob.stan", data = stan_dat, refresh = 0, iter = 2000)
print(fit.bayes.prob, pars = c("theta", "eta"))
y
mode(fit.bayes.prob)
fit.bayes.prob
fit.bayes.prob$theta
fit.bayes.prob[0]
typeof(fit.bayes.prob)
stan_dat
fit.bayes.prob
bayes.prob
mode(fit.bayes.prob, pars=c("theta"))
mode(fit.bayes.prob)
mode(fit.bayes.prob$theta)
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
vmode <- as.matrix(fit.bayes.prob, pars = "theta")
getmode(vmode)
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
vmode <- as.matrix(fit.bayes.prob, pars = "theta")
getmode(vmode)
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
vmode <- as.matrix(fit.bayes.prob, pars = "theta")
getmode(vmode)
set.seed(123);
theta <- 0.3;
N <- 10;
y <- rbinom(N, 1, theta)
stan_dat <- list(y = y,N=N)
fit.bayes.prob <- stan(file = "lab-04-prob.stan", data = stan_dat, refresh = 0, iter = 2000)
print(fit.bayes.prob, pars = c("theta", "eta"))
getmode <- function(v) {
+     uniqv <- unique(v)
+     uniqv[which.max(tabulate(match(v, uniqv)))]
+ }
>
> vmode <- as.matrix(fit.bayes.prob, pars = "theta")
> getmode(vmode)
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
vmode <- as.matrix(fit.bayes.prob, pars = "theta")
getmode(vmode)
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
vmode <- as.matrix(fit.bayes.prob, pars = "theta")
getmode(vmode)
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
vmode <- as.matrix(fit.bayes.prob, pars = "theta")
getmode(vmode)
vmode
head(vmode)
head(vmode)
set.seed(123);
theta <- 0.3;
N <- 10;
y <- rbinom(N, 1, theta)
stan_dat <- list(y = y,N=N)
fit.bayes.prob <- stan(file = "lab-04-prob.stan", data = stan_dat, refresh = 0, iter = 2000)
print(fit.bayes.prob, pars = c("theta", "eta"))
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
vmode <- as.matrix(fit.bayes.prob, pars = "theta")
getmode(vmode)
y <- rbinom(N, 1, theta)
head(vmode)
plot(vmode)
density(vmode)
histogram(vmode)
hist(vmode)
set.seed(123)
getmode <- function(v) {
+    uniqv <- unique(v)
+    uniqv[which.max(tabulate(match(v, uniqv)))]
+ }
>
> vmode <- as.matrix(fit.bayes.prob, pars = "theta")
> getmode(vmode)
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
vmode <- as.matrix(fit.bayes.prob, pars = "theta")
getmode(vmode)
length(vmode)
print(fit.flat, pars=c("alpha"))
M <- as.matrix(fit.bayes.prob, pars = "theta")
hist(M)
M
hist(M)
M <- as.matrix(fit.bayes.prob, pars = "theta")
hist(M)
