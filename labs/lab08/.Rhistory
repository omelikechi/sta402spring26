require(tidyverse)
require(rstanarm)
require(magrittr)
library(tidyverse)
library(ggplot2)
require(loo)
require(bayesplot)
require(caret)
library(rstan)
require(HSAUR3)
knitr::opts_chunk$set(fig.align = 'center')
# Ordinary least squares
ols <- lm(rainfall ~ seeding * (sne + cloudcover + prewetness + echomotion) + time,
data = clouds)
summary(ols)
beta0.prior <- cauchy()
beta.prior <- cauchy()
stan.glm <- stan_glm(data = clouds,
formula = rainfall ~ seeding*(sne + cloudcover + prewetness + echomotion) + time,
family = gaussian(),
prior = beta.prior,
prior_intercept = beta0.prior,
refresh = 0,
refresh = 0)
summary(stan.glm)
confint(ols)
posterior_interval(stan.glm, prob=0.95)
freq.mod <- glm(admit ~. , data = admissions,
family = binomial())
# Acceptance data
seed <- 196
admissions <- read.csv("https://stats.idre.ucla.edu/stat/data/binary.csv")
admissions$rank <- factor(admissions$rank)
admissions$admit <- factor(admissions$admit)
admissions$gre <- scale(admissions$gre)
p <- 5
n <- nrow(admissions)
freq.mod <- glm(admit ~. , data = admissions,
family = binomial())
summary(freq.mod)
launch_shinystan(post1)
post1 <- stan_glm(admit ~ ., data = admissions,
family = binomial(link = "logit"),
prior = normal(0,1), prior_intercept = normal(0,1),
seed = seed,
refresh = 0)
launch_shinystan(post1)
post1 <- stan_glm(admit ~ ., data = admissions,
family = binomial(link = "logit"),
prior = normal(0,1), prior_intercept = normal(0,1),
seed = seed,
refresh = 0)
#launch_shinystan(post1)
mcmc_areas(as.matrix(post1), prob = 0.95, prob_outer = 1)
round(coef(post1), 3)
round(posterior_interval(post1, prob = 0.95), 3)
mcmc_areas(as.matrix(post1), prob = 0.95, prob_outer = 1)
round(coef(post1), 3)
round(posterior_interval(post1, prob = 0.95), 3)
posterior_interval(freq.mod, prob=0.95)
confint(freq.mod, prob=0.95)
posterior_interval(post1, prob=0.95)
confint(freq.mod, prob=0.95)
posterior_interval(post1, prob=0.95)
mcmc_areas(as.matrix(post1), prob = 0.95, prob_outer = 1)
round(coef(post1), 3)
round(posterior_interval(post1, prob = 0.95), 3)
summary(post1)
summary(post1)
mcmc_areas(as.matrix(post1), prob = 0.95, prob_outer = 1)
round(coef(post1), 3)
round(posterior_interval(post1, prob = 0.95), 3)
loo1 <- loo(post1, save_psis = TRUE)
(loo1 <- loo(post1, save_psis = TRUE))
post0 <- stan_glm(admit ~ 1, data = admissions,
family = binomial(link = "logit"),
prior = normal(0,1), prior_intercept = normal(0,1),
seed = seed,
refresh = 0)
(loo0 <- loo(post0, save_psis = T))
(loo1 <- loo(post1, save_psis = TRUE))
post0 <- stan_glm(admit ~ 1, data = admissions,
family = binomial(link = "logit"),
prior = normal(0,1), prior_intercept = normal(0,1),
seed = seed,
refresh = 0)
(loo0 <- loo(post0, save_psis = T))
rstanarm::loo_compare(loo0, loo1)
p0 <- 2 # prior guess for the number of relevant variables
tau0 <- p0/(p-p0) * 1/sqrt(n) # recommended by Pilronen and Vehtari (2017)
hs_prior <- hs(df=1, global_df=1, global_scale=tau0)
post2 <- stan_glm(admit ~ ., data = admissions,
family = binomial(link = "logit"),
prior = hs_prior, prior_intercept = normal(0,1),
seed = seed,
refresh = 0)
round(coef(post2), 3)
round(posterior_interval(post2, prob = 0.95), 3)
mcmc_areas(as.matrix(post2), prob = 0.95, prob_outer = 1)
round(posterior_interval(post1, prob = 0.95), 3)
round(posterior_interval(post2, prob = 0.95), 3)
round(coef(post1), 3)
round(coef(post2), 3)
round(posterior_interval(post1, prob = 0.95), 3)
round(posterior_interval(post2, prob = 0.95), 3)
(loo2 <- loo(post2, save_psis = T))
rstanarm::loo_compare(loo1, loo2)
