library(mvtnorm)
library(coda)
knitr::opts_chunk$set(fig.align = 'center')
X, Y, Z <- 0, 0, 0
1+1
sqrt(4)
# Gibbs sampling
# Initial data
T <- 1000
X <- 0
Y <- 0
z <- 0
M <- matrix(nrow = T, ncol = 3)
M[1,] <- c(X,Y,Z)
# Gibbs sampling
# Initial data
T <- 1000
X <- 0
Y <- 0
Z <- 0
M <- matrix(nrow = T, ncol = 3)
M[1,] <- c(X,Y,Z)
# Gibbs algorithm
for(i in 2:T){
X <- rnorm(1, (89/99)*Y+(1/99)*Z, sqrt(94/95))
Y <- rnorm(1, (89/99)*X+(1/99)*Z, sqrt(94/95))
Z <- rnorm(1, (1/19)*(X+Y), sqrt(94/95))
M[i,] <- c(X,Y,Z)
}
# Trace plot
plot(M[,1], ylab=expression(X), main=expression("Trace plot for" ~ X))
# Gibbs sampling
# Initial data
T <- 1000
X <- 0
Y <- 0
Z <- 0
M <- matrix(nrow = T, ncol = 3)
M[1,] <- c(X,Y,Z)
# Gibbs algorithm
for(i in 2:T){
X <- rnorm(1, (89/99)*Y+(1/99)*Z, sqrt(94/95))
Y <- rnorm(1, (89/99)*X+(1/99)*Z, sqrt(94/95))
Z <- rnorm(1, (1/19)*(X+Y), sqrt(94/95))
M[i,] <- c(X,Y,Z)
}
# Trace plot
plot(M[,1], ylab=expression(X), main=expression("Trace plot for" ~ X))
autocorr.plot(M[,1])
# Gibbs sampling
# Initial data
T <- 1000
X <- 0
Y <- 0
Z <- 0
M <- matrix(nrow = T, ncol = 3)
M[1,] <- c(X,Y,Z)
# Gibbs algorithm
for(i in 2:T){
X <- rnorm(1, (89/99)*Y+(1/99)*Z, sqrt(94/95))
Y <- rnorm(1, (89/99)*X+(1/99)*Z, sqrt(94/95))
Z <- rnorm(1, (1/19)*(X+Y), sqrt(94/95))
M[i,] <- c(X,Y,Z)
}
# Trace plot
plot(M[,1], ylab=expression(X), main=expression("Trace plot for" ~ X))
autocorr.plot(M[,1], auto.layout = T)
# Gibbs sampling
# Initial data
T <- 1000
X <- 0
Y <- 0
Z <- 0
M <- matrix(nrow = T, ncol = 3)
M[1,] <- c(X,Y,Z)
# Gibbs algorithm
for(i in 2:T){
X <- rnorm(1, (89/99)*Y+(1/99)*Z, sqrt(94/95))
Y <- rnorm(1, (89/99)*X+(1/99)*Z, sqrt(94/95))
Z <- rnorm(1, (1/19)*(X+Y), sqrt(94/95))
M[i,] <- c(X,Y,Z)
}
# Trace plot
plot(M[,1], ylab=expression(X), main=expression("Trace plot for" ~ X))
autocorr.plot(M[,1], width=10, height=10)
# Gibbs sampling
# Initial data
T <- 1000
X <- 0
Y <- 0
Z <- 0
M <- matrix(nrow = T, ncol = 3)
M[1,] <- c(X,Y,Z)
# Gibbs algorithm
for(i in 2:T){
X <- rnorm(1, (89/99)*Y+(1/99)*Z, sqrt(94/95))
Y <- rnorm(1, (89/99)*X+(1/99)*Z, sqrt(94/95))
Z <- rnorm(1, (1/19)*(X+Y), sqrt(94/95))
M[i,] <- c(X,Y,Z)
}
# Trace plot
plot(M[,1], ylab=expression(X), main=expression("Trace plot for" ~ X))
dev.new(width=10, height=5, unit="in")
autocorr.plot(M[,1], width=10, height=10)
# Gibbs sampling
# Initial data
T <- 1000
X <- 0
Y <- 0
Z <- 0
M <- matrix(nrow = T, ncol = 3)
M[1,] <- c(X,Y,Z)
# Gibbs algorithm
for(i in 2:T){
X <- rnorm(1, (89/99)*Y+(1/99)*Z, sqrt(94/95))
Y <- rnorm(1, (89/99)*X+(1/99)*Z, sqrt(94/95))
Z <- rnorm(1, (1/19)*(X+Y), sqrt(94/95))
M[i,] <- c(X,Y,Z)
}
# Trace plot
plot(M[,1], ylab=expression(X), main=expression("Trace plot for" ~ X))
autocorr.plot(M[,1], width=10, height=10)
# Gibbs sampling
# Initial data
T <- 1000
X <- 0
Y <- 0
Z <- 0
M <- matrix(nrow = T, ncol = 3)
M[1,] <- c(X,Y,Z)
# Gibbs algorithm
for(i in 2:T){
X <- rnorm(1, (89/99)*Y+(1/99)*Z, sqrt(94/95))
Y <- rnorm(1, (89/99)*X+(1/99)*Z, sqrt(94/95))
Z <- rnorm(1, (1/19)*(X+Y), sqrt(94/95))
M[i,] <- c(X,Y,Z)
}
# Trace plot
plot(M[,1], ylab=expression(X), main=expression("Trace plot for" ~ X))
dev.new(width=10, height=5, unit="in")
autocorr.plot(M[,1])
# Gibbs sampling
# Initial data
T <- 1000
X <- 0
Y <- 0
Z <- 0
M <- matrix(nrow = T, ncol = 3)
M[1,] <- c(X,Y,Z)
# Gibbs algorithm
for(i in 2:T){
X <- rnorm(1, (89/99)*Y+(1/99)*Z, sqrt(94/95))
Y <- rnorm(1, (89/99)*X+(1/99)*Z, sqrt(94/95))
Z <- rnorm(1, (1/19)*(X+Y), sqrt(94/95))
M[i,] <- c(X,Y,Z)
}
# Trace plot
plot(M[,1], ylab=expression(X), main=expression("Trace plot for" ~ X))
autocorr.plot(M[,1])
# Gibbs sampling
# Initial data
T <- 1000
X <- 0
Y <- 0
Z <- 0
M <- matrix(nrow = T, ncol = 3)
M[1,] <- c(X,Y,Z)
# Gibbs algorithm
for(i in 2:T){
X <- rnorm(1, (89/99)*Y+(1/99)*Z, sqrt(94/95))
Y <- rnorm(1, (89/99)*X+(1/99)*Z, sqrt(94/95))
Z <- rnorm(1, (1/19)*(X+Y), sqrt(94/95))
M[i,] <- c(X,Y,Z)
}
# Trace plot
plot(M[,1], ylab=expression(X), main=expression("Trace plot for" ~ X))
autocorr.plot(M[,1])
autocorr.plot(M[,1])
dev.new(width=5, height=4)
autocorr.plot(M[,1])
dev.new(width=15, height=20)
autocorr.plot(M[,1])
plot(a)
dev.new(width=15, height=20)
a <- autocorr.plot(M[,1], auto.layout = F)
dev.new(width=15, height=20)
a <- autocorr.plot(M[,1], auto.layout = T)
dev.new(width=15, height=20)
autocorr.plot(M[,1], auto.layout = F)
dev.new(width=15, height=15)
autocorr.plot(M[,1], auto.layout = F)
# Gibbs sampling
# Initial data
T <- 1000
X <- 0
Y <- 0
Z <- 0
M <- matrix(nrow = T, ncol = 3)
M[1,] <- c(X,Y,Z)
# Gibbs algorithm
for(i in 2:T){
X <- rnorm(1, (89/99)*Y+(1/99)*Z, sqrt(94/95))
Y <- rnorm(1, (89/99)*X+(1/99)*Z, sqrt(94/95))
Z <- rnorm(1, (1/19)*(X+Y), sqrt(94/95))
M[i,] <- c(X,Y,Z)
}
# Trace plot
plot(M[,1], type = "l", ylab=expression(X), main=expression("Trace plot for" ~ X))
# Autocorrelation plot
autocorr.plot(M[,1], auto.layout = F)
# Gibbs sampling
# Initial data
T <- 1000
X <- 0
Y <- 0
Z <- 0
M <- matrix(nrow = T, ncol = 3)
M[1,] <- c(X,Y,Z)
# Gibbs algorithm
for(i in 2:T){
X <- rnorm(1, (89/99)*Y+(1/99)*Z, sqrt(94/95))
Y <- rnorm(1, (89/99)*X+(1/99)*Z, sqrt(94/95))
Z <- rnorm(1, (1/19)*(X+Y), sqrt(94/95))
M[i,] <- c(X,Y,Z)
}
# Trace plot
plot(M[,1], type = "l", ylab=expression(X), main = expression("Trace plot for" ~ X))
# Autocorrelation plot
autocorr.plot(M[,1], main = expression("Autocorrelation plot for" ~ X), auto.layout = F)
(a,b) <- c(1,2)
a <- 1
b <- 2
c(a,b) <- (3,4)
c(a,b) <- c(3,4)
a,b <- 1,2
2*c(1,2)
matrix(c(1,2,3,4), nrow=2, ncol=2)
Z <- 0
rmvnorm(1, (1/10)*c(Z,Z), matrix(c(99/100, 89/100, 89/100, 99/100), nrow=2, ncol=2))
rmvnorm(1, (1/10)*c(Z,Z), matrix(c(99/100, 89/100, 89/100, 99/100), nrow=2, ncol=2))[1]
rmvnorm(1, (1/10)*c(Z,Z), matrix(c(99/100, 89/100, 89/100, 99/100), nrow=2, ncol=2))[2]
# Gibbs sampling
# Initial data
T <- 1000
X <- 0
Y <- 0
Z <- 0
M <- matrix(nrow = T, ncol = 3)
M[1,] <- c(X,Y,Z)
# Gibbs algorithm
for(i in 2:T){
a <- rmvnorm(1, (1/10)*c(Z,Z), matrix(c(99/100, 89/100, 89/100, 99/100), nrow=2, ncol=2))
X <- a[1]
Y <- a[2]
Z <- rnorm(1, (1/19)*(X+Y), sqrt(94/95))
M[i,] <- c(X,Y,Z)
}
# Trace plot
plot(M[,1], type = "l", ylab=expression(X), main = expression("Trace plot for" ~ X))
# Autocorrelation plot
autocorr.plot(M[,1], main = expression("Autocorrelation plot for" ~ X), auto.layout = F)
